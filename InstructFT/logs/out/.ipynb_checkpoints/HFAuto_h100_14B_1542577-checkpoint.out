[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[NeMo I 2025-11-09 13:08:30 nemo_logging:393] use_linear_ce_loss: False
Using FSDP2 with DP=16, TP=4, CP=1
[NeMo I 2025-11-09 13:08:30 nemo_logging:393] Bad message (TypeError('not all arguments converted during string formatting')): {'name': 'nemo_logger', 'msg': 'You are using a huggingface TP plan. Make sure your model is a huggingface model. Certain ', 'args': ('parallelizations might not be supported. SP option will also be ignored.',), 'levelname': 'INFO', 'levelno': 20, 'pathname': '/lustre/fshomisc/sup/pub/miniforge/24.11.3/envs/nemo-2.4.0+py3.12.10/lib/python3.12/site-packages/nemo/utils/nemo_logging.py', 'filename': 'nemo_logging.py', 'module': 'nemo_logging', 'exc_info': None, 'exc_text': None, 'stack_info': None, 'lineno': 393, 'funcName': 'info', 'created': 1762690110.3031456, 'msecs': 303.0, 'relativeCreated': 62071.343183517456, 'thread': 22933899660352, 'threadName': 'MainThread', 'processName': 'MainProcess', 'process': 295048, 'taskName': None}
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[NeMo I 2025-11-09 13:08:30 nemo_logging:393] Using passed HF dataset Dataset({
        features: ['id', 'messages', 'source'],
        num_rows: 939343
    })
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[NeMo I 2025-11-09 13:08:30 nemo_logging:393] Experiments will be logged at /tmp/tmpfr672taa/nemo2_finetune
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
[warn] tp_size>1 with HFAutoModel: enabling --use-hf-tp-plan
Accumulate grad batches: 1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
Using FSDP2 with DP=16, TP=4, CP=1
[NeMo I 2025-11-09 13:08:38 nemo_logging:393] Configuring model with attn_implementation: sdpa
